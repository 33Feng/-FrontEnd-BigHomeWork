{"ast":null,"code":"import { withKeys as _withKeys, createVNode as _createVNode, withCtx as _withCtx, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"qa-panel\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  style: {\n    \"margin-bottom\": \"10px\"\n  }\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"answer-container\"\n};\nconst _hoisted_5 = {\n  class: \"answer-text\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode($setup[\"ElForm\"], {\n    onSubmit: _withModifiers($setup.submitQuestion, [\"prevent\"])\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"ElFormItem\"], {\n      label: \"请输入问题：\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"ElInput\"], {\n        modelValue: $setup.question,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.question = $event),\n        placeholder: \"例如：Vue3有哪些新特性？Vite的特性是什么？\",\n        clearable: \"\",\n        onKeyup: _withKeys($setup.submitQuestion, [\"enter\"])\n      }, null, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createCommentVNode(\" 新增：快速提问按钮（基于图谱选中的实体） \"), $props.currentEntity ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode($setup[\"ElButton\"], {\n      type: \"text\",\n      onClick: $setup.quickAsk\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"快速提问：\" + _toDisplayString($props.currentEntity) + \"相关知识\", 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    })])) : _createCommentVNode(\"v-if\", true), _createVNode($setup[\"ElFormItem\"], null, {\n      default: _withCtx(() => [_createVNode($setup[\"ElButton\"], {\n        type: \"primary\",\n        onClick: $setup.submitQuestion\n      }, {\n        default: _withCtx(() => [...(_cache[1] || (_cache[1] = [_createTextVNode(\"提交问题\", -1 /* CACHED */)]))]),\n        _: 1 /* STABLE */\n      }), _createVNode($setup[\"ElButton\"], {\n        onClick: $setup.resetForm\n      }, {\n        default: _withCtx(() => [...(_cache[2] || (_cache[2] = [_createTextVNode(\"清空\", -1 /* CACHED */)]))]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 加载状态提示 \"), _ctx.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"正在生成答案，请稍候...\")) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 回答展示 \"), $setup.answer ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[3] || (_cache[3] = _createElementVNode(\"h3\", null, \"回答：\", -1 /* CACHED */)), _createVNode($setup[\"ElCard\"], null, {\n    default: _withCtx(() => [_createElementVNode(\"pre\", _hoisted_5, _toDisplayString($setup.answer), 1 /* TEXT */)]),\n    _: 1 /* STABLE */\n  })])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 推荐面板 \"), _createVNode($setup[\"RecommendPanel\"], {\n    recommendations: $setup.recommendations\n  }, null, 8 /* PROPS */, [\"recommendations\"])]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","_createVNode","$setup","onSubmit","_withModifiers","submitQuestion","label","question","$event","placeholder","clearable","onKeyup","_withKeys","_createCommentVNode","$props","currentEntity","_hoisted_2","type","onClick","quickAsk","_toDisplayString","_cache","resetForm","_ctx","isLoading","_hoisted_3","answer","_hoisted_4","_createElementVNode","_hoisted_5","recommendations"],"sources":["D:\\前端大作业\\kg-system\\frontend\\src\\components\\QaPanel.vue"],"sourcesContent":["<template>\r\n  <div class=\"qa-panel\">\r\n    <el-form @submit.prevent=\"submitQuestion\">\r\n      <el-form-item label=\"请输入问题：\">\r\n        <el-input\r\n          v-model=\"question\"\r\n          placeholder=\"例如：Vue3有哪些新特性？Vite的特性是什么？\"\r\n          clearable\r\n          @keyup.enter=\"submitQuestion\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <!-- 新增：快速提问按钮（基于图谱选中的实体） -->\r\n      <div v-if=\"currentEntity\" style=\"margin-bottom: 10px;\">\r\n        <el-button type=\"text\" @click=\"quickAsk\">快速提问：{{ currentEntity }}相关知识</el-button>\r\n      </div>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitQuestion\">提交问题</el-button>\r\n        <el-button @click=\"resetForm\">清空</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 加载状态提示 -->\r\n    <div v-if=\"isLoading\" class=\"loading\">正在生成答案，请稍候...</div>\r\n\r\n    <!-- 回答展示 -->\r\n    <div class=\"answer-container\" v-if=\"answer\">\r\n      <h3>回答：</h3>\r\n      <el-card>\r\n        <pre class=\"answer-text\">{{ answer }}</pre>\r\n      </el-card>\r\n    </div>\r\n\r\n    <!-- 推荐面板 -->\r\n    <RecommendPanel :recommendations=\"recommendations\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, defineEmits, defineProps, watch } from 'vue';\r\nimport { ElForm, ElFormItem, ElInput, ElButton, ElCard, ElMessage } from 'element-plus';\r\nimport { api } from '../api/index';\r\nimport RecommendPanel from './RecommendPanel.vue';\r\n\r\n// 接收父组件传递的图谱选中实体\r\nconst props = defineProps({\r\n  currentEntity: {\r\n    type: String,\r\n    default: ''\r\n  }\r\n});\r\n\r\n// 定义emit，向父组件传递核心实体\r\nconst emit = defineEmits(['update:mainEntity']);\r\n\r\n// 响应式数据\r\nconst question = ref('');\r\nconst answer = ref('');\r\nconst recommendations = ref([]);\r\nconst mainEntity = ref(''); // 核心实体\r\n\r\n// 提交问题\r\nconst submitQuestion = async () => {\r\n  if (!question.value.trim()) {\r\n    ElMessage.warning('请输入问题！');\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const res = await api.qa(question.value);\r\n    answer.value = res.data.answer;\r\n    recommendations.value = res.data.recommendations;\r\n    // 获取核心实体（问答返回的related_entities中取第一个）\r\n    mainEntity.value = res.data.related_entities[0] || '';\r\n    // 向父组件发送核心实体\r\n    emit('update:mainEntity', mainEntity.value);\r\n  } catch (error) {\r\n    ElMessage.error('获取回答失败：' + (error.message || '未知错误'));\r\n  }\r\n};\r\n\r\n// 重置表单\r\nconst resetForm = () => {\r\n  question.value = '';\r\n  answer.value = '';\r\n  recommendations.value = [];\r\n  mainEntity.value = '';\r\n  // 重置时通知父组件清空实体（显示全量图谱）\r\n  emit('update:mainEntity', '');\r\n};\r\n\r\n// 新增：基于图谱选中的实体快速提问\r\nconst quickAsk = () => {\r\n  if (props.currentEntity) {\r\n    question.value = `${props.currentEntity}相关知识有哪些？`;\r\n    submitQuestion();\r\n  }\r\n};\r\n\r\n// 监听图谱实体变化，自动填充问题（可选）\r\nwatch(\r\n  () => props.currentEntity,\r\n  (newEntity) => {\r\n    if (newEntity && !question.value.trim()) {\r\n      question.value = `${newEntity}相关知识有哪些？`;\r\n    }\r\n  },\r\n  { immediate: true }\r\n);\r\n</script>\r\n\r\n<style scoped>\r\n/* 原有样式不变 */\r\n.qa-panel {\r\n  margin-bottom: 20px;\r\n}\r\n.answer-container {\r\n  margin-top: 20px;\r\n}\r\n.answer-text {\r\n  white-space: pre-wrap;\r\n  font-size: 14px;\r\n  line-height: 1.6;\r\n  color: #333;\r\n  margin: 0;\r\n}\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAU;;;EAWSC,KAA4B,EAA5B;IAAA;EAAA;;;;EAUND,KAAK,EAAC;;;;EAGvBA,KAAK,EAAC;;;EAGFA,KAAK,EAAC;AAAa;;uBA3B9BE,mBAAA,CAiCM,OAjCNC,UAiCM,GAhCJC,YAAA,CAiBUC,MAAA;IAjBAC,QAAM,EAAAC,cAAA,CAAUF,MAAA,CAAAG,cAAc;;sBACtC,MAOe,CAPfJ,YAAA,CAOeC,MAAA;MAPDI,KAAK,EAAC;IAAQ;wBAC1B,MAKY,CALZL,YAAA,CAKYC,MAAA;oBAJDA,MAAA,CAAAK,QAAQ;mEAARL,MAAA,CAAAK,QAAQ,GAAAC,MAAA;QACjBC,WAAW,EAAC,2BAA2B;QACvCC,SAAS,EAAT,EAAS;QACRC,OAAK,EAAAC,SAAA,CAAQV,MAAA,CAAAG,cAAc;;;QAGhCQ,mBAAA,0BAA6B,EAClBC,MAAA,CAAAC,aAAa,I,cAAxBhB,mBAAA,CAEM,OAFNiB,UAEM,GADJf,YAAA,CAAiFC,MAAA;MAAtEe,IAAI,EAAC,MAAM;MAAEC,OAAK,EAAEhB,MAAA,CAAAiB;;wBAAU,MAAK,C,iBAAL,OAAK,GAAAC,gBAAA,CAAGN,MAAA,CAAAC,aAAa,IAAG,MAAI,gB;;+CAEvEd,YAAA,CAGeC,MAAA;wBAFb,MAAkE,CAAlED,YAAA,CAAkEC,MAAA;QAAvDe,IAAI,EAAC,SAAS;QAAEC,OAAK,EAAEhB,MAAA,CAAAG;;0BAAgB,MAAI,KAAAgB,MAAA,QAAAA,MAAA,O,iBAAJ,MAAI,mB;;UACtDpB,YAAA,CAA4CC,MAAA;QAAhCgB,OAAK,EAAEhB,MAAA,CAAAoB;MAAS;0BAAE,MAAE,KAAAD,MAAA,QAAAA,MAAA,O,iBAAF,IAAE,mB;;;;;;MAIpCR,mBAAA,YAAe,EACJU,IAAA,CAAAC,SAAS,I,cAApBzB,mBAAA,CAAyD,OAAzD0B,UAAyD,EAAnB,eAAa,K,mCAEnDZ,mBAAA,UAAa,EACuBX,MAAA,CAAAwB,MAAM,I,cAA1C3B,mBAAA,CAKM,OALN4B,UAKM,G,0BAJJC,mBAAA,CAAY,YAAR,KAAG,qBACP3B,YAAA,CAEUC,MAAA;sBADR,MAA2C,CAA3C0B,mBAAA,CAA2C,OAA3CC,UAA2C,EAAAT,gBAAA,CAAflB,MAAA,CAAAwB,MAAM,iB;;6CAItCb,mBAAA,UAAa,EACbZ,YAAA,CAAqDC,MAAA;IAApC4B,eAAe,EAAE5B,MAAA,CAAA4B;EAAe,6C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}